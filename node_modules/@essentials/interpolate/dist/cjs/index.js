'use strict'

exports.__esModule = true
exports.default = exports.linear = void 0

var _performanceNow = _interopRequireDefault(require('performance-now'))

var _raf = _interopRequireDefault(require('raf'))

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {default: obj}
}

const linear = pos => pos

exports.linear = linear

const calcPosition = (from, to, t) => from + (to - from) * t

const calcObjOrInt = (from, to, t) => {
  let output

  if (typeof from === 'object') {
    output = Array.isArray(from) ? [] : {}

    for (let key in from) {
      output[key] = calcPosition(from[key], to[key], t)
    }
  } else {
    output = calcPosition(from, to, t)
  }

  return output
}

var _default = (fn, {from = 0, to = 1, duration = 240, timing = linear}) => {
  const start = (0, _performanceNow.default)(),
    time = start + duration

  const loop = () => {
    const p = 1 - (time - (0, _performanceNow.default)()) / (time - start),
      t = timing(p)

    if (p <= 1) {
      ;(0, _raf.default)(loop)
      fn(calcObjOrInt(from, to, t))
    } else {
      fn(calcObjOrInt(from, to, t > 1 ? 1 : t))
    }
  }

  loop()
}

exports.default = _default
