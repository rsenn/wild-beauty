function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("rematrix"),i=require("react"),n=t(i),r=(t(require("prop-types")),function(t){return"number"==typeof t}),o=function(t){return"[object Object]"===Object.prototype.toString.call(t)},s=function(t){return Array.prototype.slice.apply(t)};function a(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];return e.forEach(function(e){if(e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}),t}var l,p=function(t,e,i){return t+(e-t)*i},c={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},u=function(t){return o(t)?t:Object.keys(c).indexOf(t)>-1?c[t]:{}};"undefined"!=typeof window&&(l=window.requestAnimationFrame);var d=l=l||function(t){window.setTimeout(t,1e3/60)},f=Date.now(),h="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-f};function g(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}var m=function(){};m.prototype.run=function(){var t=this;d(function(){t.springSystem.loop(h())})};var v=function(){this.position=0,this.velocity=0},y=0,S=function(t){this._id="s"+y++,this._springSystem=t,this.listeners=[],this._startValue=0,this._currentState=new v,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new v,this._restSpeedThreshold=.001,this._tempState=new v,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}};S.prototype.getId=function(){return this._id},S.prototype.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},S.prototype.setSpringConfig=function(t){return this._springConfig=t,this},S.prototype.getCurrentValue=function(){return this._currentState.position},S.prototype.getDisplacementDistanceForState=function(t){return Math.abs(this._endValue-t.position)},S.prototype.setEndValue=function(t){if(t===this._endValue)return this;if(this.prevEndValue=t,this._endValue===t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e].onSpringEndStateChange;n&&n(this)}return this},S.prototype.setVelocity=function(t){return t===this._currentState.velocity?this:(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId()),this)},S.prototype.setCurrentValue=function(t){this._startValue=t,this._currentState.position=t;for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e];n.onSpringUpdate&&n.onSpringUpdate(this)}return this},S.prototype.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},S.prototype.setOvershootClampingEnabled=function(t){return this._overshootClampingEnabled=t,this},S.prototype.isOvershooting=function(){var t=this._startValue,e=this._endValue;return this._springConfig.tension>0&&(t<e&&this.getCurrentValue()>e||t>e&&this.getCurrentValue()<e)},S.prototype.advance=function(t,e){var i=this.isAtRest();if(!i||!this._wasAtRest){var n=e;e>.064&&(n=.064),this._timeAccumulator+=n;for(var r,o,s,a,l,p,c=this._springConfig.tension,u=this._springConfig.friction,d=this._currentState.position,f=this._currentState.velocity,h=this._tempState.position,g=this._tempState.velocity;this._timeAccumulator>=.001;)this._timeAccumulator-=.001,this._timeAccumulator<.001&&(this._previousState.position=d,this._previousState.velocity=f),o=c*(this._endValue-h)-u*f,a=c*(this._endValue-(h=d+.001*(r=f)*.5))-u*(g=f+.001*o*.5),p=c*(this._endValue-(h=d+.001*(s=g)*.5))-u*(g=f+.001*a*.5),h=d+.001*(l=g),d+=1/6*(r+2*(s+l)+(g=f+.001*p))*.001,f+=1/6*(o+2*(a+p)+(c*(this._endValue-h)-u*g))*.001;this._tempState.position=h,this._tempState.velocity=g,this._currentState.position=d,this._currentState.velocity=f,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/.001),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),i=!0);var m=!1;this._wasAtRest&&(this._wasAtRest=!1,m=!0);var v=!1;i&&(this._wasAtRest=!0,v=!0),this.notifyPositionUpdated(m,v)}},S.prototype.notifyPositionUpdated=function(t,e){var i=this;this.listeners.filter(Boolean).forEach(function(n){t&&n.onSpringActivate&&!i._onActivateCalled&&(n.onSpringActivate(i),i._onActivateCalled=!0),n.onSpringUpdate&&n.onSpringUpdate(i),e&&n.onSpringAtRest&&n.onSpringAtRest(i)})},S.prototype.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},S.prototype.wasAtRest=function(){return this._wasAtRest},S.prototype.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},S.prototype._interpolate=function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},S.prototype.addListener=function(t){return this.listeners.push(t),this},S.prototype.addOneTimeListener=function(t){var e=this;return Object.keys(t).forEach(function(i){var n;t[i]=(n=t[i],function(){for(var i=[],r=arguments.length;r--;)i[r]=arguments[r];n.apply(void 0,i),e.removeListener(t)})}),this.listeners.push(t),this},S.prototype.removeListener=function(t){return g(this.listeners,t),this};var _=function(t){this.looper=t||new m,this.looper.springSystem=this,this.listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}};_.prototype.createSpring=function(t,e){return this.createSpringWithConfig({tension:t,friction:e})},_.prototype.createSpringWithConfig=function(t){var e=new S(this);return this.registerSpring(e),e.setSpringConfig(t),e},_.prototype.getIsIdle=function(){return this._isIdle},_.prototype.registerSpring=function(t){this._springRegistry[t.getId()]=t},_.prototype.deregisterSpring=function(t){g(this._activeSprings,t),delete this._springRegistry[t.getId()]},_.prototype.advance=function(t,e){for(var i=this;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(n){n.systemShouldAdvance()?n.advance(t/1e3,e/1e3):i._idleSpringIndices.push(i._activeSprings.indexOf(n))});this._idleSpringIndices.length>0;){var n=this._idleSpringIndices.pop();n>=0&&this._activeSprings.splice(n,1)}},_.prototype.loop=function(t){var e;-1===this._lastTimeMillis&&(this._lastTimeMillis=t-1);var i=t-this._lastTimeMillis;this._lastTimeMillis=t;var n=0,r=this.listeners.length;for(n=0;n<r;n++)(e=this.listeners[n]).onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,i),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),n=0;n<r;n++)(e=this.listeners[n]).onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},_.prototype.activateSpring=function(t){var e=this._springRegistry[t];-1===this._activeSprings.indexOf(e)&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())};var E=new _,C=function(t){var e=t.springConfig,i=e.overshootClamping,n=t.getOnUpdateFunc,r=t.onAnimationEnd,o=t.isGestureControlled,s=t.onSpringActivate,a=E.createSpring(e.stiffness,e.damping);a.setOvershootClampingEnabled(!!i);var l={onSpringActivate:s,onSpringAtRest:o?function(){}:function(){a.destroy(),r()},onSpringUpdate:n({spring:a,onAnimationEnd:r})};return a.addListener(l),a},I=function(t){var e=C(t);return e.setEndValue(1),e},w=function(t,e,i){if(void 0===e&&(e={}),t&&t.length){e.reverse&&t.reverse();var n,r="number"!=typeof(n=e.speed)?1.1:1+Math.min(Math.max(5*n,0),5),o=1/Math.max(Math.min(t.length,100),10),s=t.map(function(t,e){var n=t.getOnUpdateFunc;return t.getOnUpdateFunc=function(t){var a=n(t);return function(t){var n=t.getCurrentValue();((n=n<.01?0:n>.99?1:n)>=o||i)&&s[e+1]&&s[e+1](Math.max(Math.min(n*r,1),0)),a(t)}},t}).map(function(t){var e=C(Object.assign({},t,{isGestureControlled:i}));if(e)return e.setEndValue.bind(e)}).filter(Boolean);s[0]&&!i&&s[0](1)}},b=function(t){return[0,1,4,5,12,13].map(function(e){return t[e]})},A=function(t){return t.top<window.innerHeight&&t.bottom>0&&t.left<window.innerWidth&&t.right>0},O=function(t,e){var i;return a(t,((i={})[e[0]]=e[1],i))},x=function(t,e){return s(e?document.querySelectorAll('[data-portal-key="'+e+'"]'):t.querySelectorAll("[data-flip-id]"))},P=function(t){return t.map(function(t){return[t,t.getBoundingClientRect()]})},F={event:void 0,target:void 0,time:void 0,xy:[0,0],delta:[0,0],initial:[0,0],previous:[0,0],local:[0,0],lastLocal:[0,0],velocity:0,distance:0,down:!1,first:!0},D={window:window,touchOnly:!1,onDown:void 0,onUp:void 0},U=function(t){return function(e){var i=e.inProgressAnimations,n=e.onFinished,r=e.velocity;void 0===r&&(r=1);var o=Object.keys(i).map(function(e){var n=i[e],o=n.spring,s=n.onAnimationEnd;return o?(Object.keys(o._cachedSpringConfig).length&&o.setSpringConfig(o._cachedSpringConfig),o.setVelocity(Math.max(Math.min(r,15),2)).setEndValue(t),new Promise(function(n,r){o.addOneTimeListener({onSpringAtRest:function(o){if(o.getCurrentValue()!==t)return r();n(),1===t&&s(),function(t,e){t[e]&&t[e].spring&&t[e].spring.destroy(),delete t[e]}(i,e)}})})):Promise.reject()});Promise.all(o).then(n)}},V=U(1),j=U(0),M=function(t){this.props=t,this.flipInitiatorData=void 0,this.isFinishing=!1,this.prevProps={};var e=function(t){var e,i,n,r,o,s,a,l,p,c,u=F;return e=function(t){return u=t(u)},i={onAction:t.onAction,config:Object.assign(D,t.config)},n=i.onAction,o=function(t){e(function(e){var i=Object.assign({},e,{down:!1,first:!1});return n&&n(i),r.onUp&&r.onUp(i),Object.assign({},i,{event:t,lastLocal:e.local})})},s=function(t){var i=t.touches?t.touches[0]:t,r=i.pageX,o=i.pageY;e(function(e){var i=Date.now(),s=r-e.xy[0],a=o-e.xy[1],l=r-e.initial[0],p=o-e.initial[1],c=Math.sqrt(l*l+p*p),u=Math.sqrt(s*s+a*a),d=Object.assign({},e,{event:t,time:i,xy:[r,o],delta:[l,p],local:[e.lastLocal[0]+r-e.initial[0],e.lastLocal[1]+o-e.initial[1]],velocity:u/(i-e.time),distance:c,previous:e.xy,first:!1});return n&&n(d),Object.assign({},d)})},a=function(t){t.targetTouches&&t.targetTouches.length>1||r.maxWidth&&!window.matchMedia("screen and (max-width: "+r.maxWidth+"px)")||(r.touchOnly||(r.window.addEventListener("mousemove",s,{passive:!0}),r.window.addEventListener("mouseup",p,{passive:!0})),r.window.addEventListener("touchmove",s,{passive:!0}),r.window.addEventListener("touchend",p,{passive:!0}),function(t){var i=t.touches?t.touches[0]:t,s=i.target,a=i.pageX,p=i.pageY;e(function(e){var i=e.lastLocal||F.lastLocal,c=Object.assign({},F,{event:t,target:s,lastLocal:i,local:i,xy:[a,p],initial:[a,p],previous:[a,p],down:!0,time:Date.now(),cancel:function(){l(),d(function(){return o(t)})}});return n(c),r.onDown&&r.onDown(c),Object.assign({},c)})}(t))},l=function(){r.touchOnly||(r.window.removeEventListener("mousemove",s,{passive:!0}),r.window.removeEventListener("mouseup",p,{passive:!0})),r.window.removeEventListener("touchmove",s,{passive:!0}),r.window.removeEventListener("touchend",p,{passive:!0})},p=function(t){l(),o(t)},c={},(r=i.config).touchOnly||(c.onMouseDown=a),c.onTouchStart=a,{handlers:c,set:e}}({onAction:this.onAction.bind(this),config:this.props}),i=e.set;this.handlers=e.handlers,this.set=i};M.prototype.onAction=function(t){var e=this,i=t.velocity,n=t.delta,r=n[0],o=n[1],s=t.down,a=t.first;if(!(this.isFinishing||a&&r+o===0)){var l=this.props,p=l.inProgressAnimations,c=l.setIsGestureInitiated,u=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(i[n]=t[n]);return i}(l,["inProgressAnimations","setIsGestureInitiated"]),d=String(this.props.flipId);if(p&&c){var f=Boolean(Object.keys(p).length),h=function(){e.flipInitiatorData&&e.flipInitiatorData.cancelFlip({props:e.props,prevProps:e.prevProps}),delete e.flipInitiatorData,e.isFinishing=!1},g=["left","right","up","down"].map(function(t){return u[t]?Object.assign({direction:t,threshold:e.props.threshold||.15},u[t]):null}).filter(Boolean),m=function(t,e){return Math.abs(t)>Math.abs(e)?t>0?"right":"left":e>0?"down":"up"}(r,o),v=g.filter(function(t){return t.direction===m})[0];if(!f){if(!v)return;return function(t){e.flipInitiatorData=Object.assign({},t),e.set(function(t){return Object.assign({},t,{initial:t.xy})}),c(!0),t.initFlip({props:e.props,prevProps:e.prevProps}),setTimeout(function(){p[d]?Object.keys(p).forEach(function(t){d&&(p[t].flipInitiator=d)}):delete e.flipInitiatorData},0)}(v)}if(this.flipInitiatorData){var y=function(){e.isFinishing=!0,j({velocity:i,inProgressAnimations:p,onFinished:h})};if(this.flipInitiatorData.direction!==m&&f&&!s)return y();var S=function(t){var e=t.deltaX,i=t.deltaY;return{up:-i,down:i,left:-e,right:e}[t.direction]}({deltaX:r,deltaY:o,direction:this.flipInitiatorData.direction});if(S<=0&&!a)return h();var _=p[d].difference,E=_.translateXDifference,C=_.translateYDifference,I=_.prevRect,w=_.currentRect,b=S/Math.abs(["up","down"].indexOf(this.flipInitiatorData.direction)>-1?w.height-I.height+C:w.width-w.width+E);return!s&&b<this.flipInitiatorData.threshold?y():b>this.flipInitiatorData.threshold?(this.isFinishing=!0,V({velocity:i,inProgressAnimations:p,onFinished:function(){delete e.flipInitiatorData,delete e.isFinishing}})):void function(t){var e=t.inProgressAnimations,i=t.percentage;Object.keys(e).forEach(function(t){var n=e[t].spring;Object.keys(n._cachedSpringConfig).length||(e[t].spring._cachedSpringConfig=e[t].spring._springConfig),n.setSpringConfig({tension:300,friction:26}),e[t].spring.setEndValue(i)})}({percentage:b,inProgressAnimations:p})}}}};var R=new _,k=i.createContext({}),T=i.createContext("portal"),G=i.createContext({}),L=function(t){function i(){var e=this;t.apply(this,arguments),this.isGestureControlled=!1,this.isGestureInitiated=!1,this.inProgressAnimations={},this.flipCallbacks={},this.el=void 0,this.setIsGestureInitiated=function(){e.isGestureInitiated=!0}}return t&&(i.__proto__=t),(i.prototype=Object.create(t&&t.prototype)).constructor=i,i.prototype.getSnapshotBeforeUpdate=function(t){return this.isGestureInitiated?(this.isGestureControlled=!0,this.isGestureInitiated=!1):this.isGestureControlled=!1,t.flipKey!==this.props.flipKey&&this.el?function(t){var e=t.element,i=t.flipCallbacks;void 0===i&&(i={});var n=t.inProgressAnimations;void 0===n&&(n={});var r=x(e,t.portalKey),o=s(e.querySelectorAll("[data-inverse-flip-id]")),l={},p=[],c={};r.filter(function(t){return i&&i[t.dataset.flipId]&&i[t.dataset.flipId].onExit}).forEach(function(t){var e=t.parentNode;if(t.closest){var i=t.closest("[data-exit-container]");i&&(e=i)}var n=p.findIndex(function(t){return t[0]===e});-1===n&&(p.push([e,e.getBoundingClientRect()]),n=p.length-1),l[t.dataset.flipId]=p[n][1],c[t.dataset.flipId]=e});var u=P(r),d=u.map(function(t){var e=t[0],n=t[1],r={};if(i&&i[e.dataset.flipId]&&i[e.dataset.flipId].onExit){var o=l[e.dataset.flipId];a(r,{element:e,parent:c[e.dataset.flipId],childPosition:{top:n.top-o.top,left:n.left-o.left,width:n.width,height:n.height}})}return[e.dataset.flipId,{rect:n,opacity:parseFloat(window.getComputedStyle(e).opacity||"1"),domDataForExitAnimations:r}]}).reduce(O,{});return function(t,e){Object.keys(t).forEach(function(e){t[e].spring&&t[e].spring.destroy(),delete t[e]}),e.forEach(function(t){t.style.transform="",t.style.opacity=""})}(n,r.concat(o)),{flippedElementPositions:d,cachedOrderedFlipIds:u.map(function(t){return t[0].dataset.flipId})}}({element:this.el,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations,portalKey:this.props.portalKey}):null},i.prototype.componentDidUpdate=function(t,i,n){this.props.flipKey!==t.flipKey&&this.el&&function(t){var i=t.cachedOrderedFlipIds;void 0===i&&(i=[]);var n=t.inProgressAnimations;void 0===n&&(n={});var o=t.flippedElementPositionsBeforeUpdate;void 0===o&&(o={});var l=t.flipCallbacks;void 0===l&&(l={});var d=t.containerEl,f=t.applyTransformOrigin,h=t.spring,g=t.debug,m=t.portalKey,v=t.staggerConfig;void 0===v&&(v={});var y=t.decisionData;void 0===y&&(y={});var S=t.handleEnterUpdateDelete,_=t.isGestureControlled,E=t.onComplete,C=t.onStart,F=function(t){return P(x(t.element,t.portalKey)).map(function(t){var e=t[0],i=t[1],n=window.getComputedStyle(e);return[e.dataset.flipId,{element:e,rect:i,opacity:parseFloat(n.opacity),transform:n.transform}]}).reduce(O,{})}({element:d,portalKey:m}),D=function(t){var e=t.containerEl,i=t.portalKey;return i?function(t){return function(e){return s(document.querySelectorAll('[data-portal-key="'+t+'"]'+e))}}(i):e?function(t){var e=Math.random().toFixed(5);return t.dataset.flipperId=e,function(i){return s(t.querySelectorAll('[data-flipper-id="'+e+'"] '+i))}}(e):function(){return[]}}({containerEl:d,portalKey:m}),U=function(t){return function(e){return t('[data-flip-id="'+e+'"]')[0]}}(D),V=function(t){return o[t]&&F[t]},j=Object.keys(o).concat(Object.keys(F)).filter(function(t){return!V(t)}),M={flipCallbacks:l,getElement:U,flippedElementPositionsBeforeUpdate:o,flippedElementPositionsAfterUpdate:F,inProgressAnimations:n,decisionData:y},R=function(t){var e,i=t.unflippedIds,n=t.flipCallbacks,r=t.getElement,o=t.flippedElementPositionsBeforeUpdate,s=t.flippedElementPositionsAfterUpdate,a=t.inProgressAnimations,l=t.decisionData,p=i.filter(function(t){return s[t]}).filter(function(t){return n[t]&&n[t].onAppear}),c=i.filter(function(t){return o[t]&&n[t]&&n[t].onExit}),u=new Promise(function(t){e=t}),d=[],f=0,h=c.map(function(t,i){var r=o[t].domDataForExitAnimations,s=r.element,p=r.parent,c=r.childPosition,u=c.top,h=c.left,g=c.width,m=c.height;"static"===getComputedStyle(p).position&&(p.style.position="relative"),s.style.transform="matrix(1, 0, 0, 1, 0, 0)",s.style.position="absolute",s.style.top=u+"px",s.style.left=h+"px",s.style.height=m+"px",s.style.width=g+"px";var v=d.filter(function(t){return t[0]===p})[0];v||(v=[p,document.createDocumentFragment()],d.push(v)),v[1].appendChild(s),f+=1;var y=function(){try{p.removeChild(s)}catch(t){}finally{0==(f-=1)&&e()}};return a[t]={stop:y},function(){return n[t].onExit(s,i,y,l)}});return d.forEach(function(t){t[0].appendChild(t[1])}),h.length||e(),{hideEnteringElements:function(){p.forEach(function(t){var e=r(t);e&&(e.style.opacity="0")})},animateEnteringElements:function(){p.forEach(function(t,e){var i=r(t);i&&n[t].onAppear(i,e,l)})},animateExitingElements:function(){return h.forEach(function(t){return t()}),u}}}(a({},M,{unflippedIds:j})),k=R.hideEnteringElements,T=R.animateEnteringElements,G=R.animateExitingElements,L=a({},M,{containerEl:d,isGestureControlled:_,flippedIds:i.filter(V),applyTransformOrigin:f,spring:h,debug:g,staggerConfig:v,scopedSelector:D,onComplete:E});C&&C(d,y);var K=function(t){var i=L.flippedIds,n=L.flipCallbacks,o=L.inProgressAnimations,l=L.flippedElementPositionsBeforeUpdate,d=L.flippedElementPositionsAfterUpdate,f=L.applyTransformOrigin,h=L.spring,g=L.getElement,m=L.debug,v=L.staggerConfig;void 0===v&&(v={});var y=L.decisionData;void 0===y&&(y={});var S,_=L.onComplete,E=L.containerEl,C=L.isGestureControlled,O=new Promise(function(t){S=t});if(_&&O.then(function(){return _(E,y)}),!i.length)return function(){return S([]),O};var x,P=[],F=g(i[0]),D=F?F.ownerDocument.querySelector("body"):document.querySelector("body");x=i.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{}),Object.keys(x).filter(function(t){return x[t]>1});var U=i.map(function(t){var i=l[t].rect,g=d[t].rect,m=l[t].opacity,v=d[t].opacity,_=g.width<1||g.height<1,E=d[t].element;if(!A(i)&&!A(g))return!1;if(!E)return!1;var I=JSON.parse(E.dataset.flipConfig),w=function(t){void 0===t&&(t={});var e=t.flippedSpring;return a({},c.noWobble,u(t.flipperSpring),u(e))}({flipperSpring:h,flippedSpring:I.spring}),O=!0===I.stagger?"default":I.stagger,x={element:E,id:t,stagger:O,springConfig:w};if(n[t]&&n[t].shouldFlip&&!n[t].shouldFlip(y.previous,y.current))return!1;var F=Math.abs(i.left-g.left),V=Math.abs(i.top-g.top),j=F+V,M=Math.abs(i.width-g.width)+Math.abs(i.height-g.height),R=Math.abs(v-m);if(j<.5&&M<.5&&R<.01)return!1;var k=e.parse(d[t].transform),T={matrix:k},G={matrix:[]},L=[k];I.translate&&(L.push(e.translateX(i.left-g.left)),L.push(e.translateY(i.top-g.top))),I.scale&&(L.push(e.scaleX(Math.max(i.width,1)/Math.max(g.width,1))),L.push(e.scaleY(Math.max(i.height,1)/Math.max(g.height,1)))),I.opacity&&(G.opacity=m,T.opacity=v);var K=[];if(!n[t]||!n[t].shouldInvert||n[t].shouldInvert(y.previous,y.current)){var B=function(t,e){return s(t.querySelectorAll('[data-inverse-flip-id="'+e+'"]'))}(E,t);K=B.map(function(t){return[t,JSON.parse(t.dataset.flipConfig)]})}G.matrix=b(L.reduce(e.multiply)),T.matrix=b(T.matrix);var q,X=function(t){var e=t.element,i=t.invertedChildren,n=t.body;return function(t){var o=t.matrix,s=t.opacity,a=t.forceMinVals;if(r(s)&&(e.style.opacity=s+""),a&&(e.style.minHeight="1px",e.style.minWidth="1px"),o){var l=function(t){return"matrix("+t.join(", ")+")"}(o);e.style.transform=l,i&&function(t){var e=t.matrix,i=t.body;t.invertedChildren.forEach(function(t){var n=t[0],r=t[1];if(i.contains(n)){var o=e[0],s=e[3],a=e[5],l={translateX:0,translateY:0,scaleX:1,scaleY:1},p="";r.translate&&(l.translateX=-e[4]/o,l.translateY=-a/s,p+="translate("+l.translateX+"px, "+l.translateY+"px)"),r.scale&&(l.scaleX=1/o,l.scaleY=1/s,p+=" scale("+l.scaleX+", "+l.scaleY+")"),n.style.transform=p}})}({invertedChildren:i,matrix:o,body:n})}}}({element:E,invertedChildren:K,body:D});if(n[t]&&n[t].onComplete){var Y=n[t].onComplete;q=function(){return Y(E,y)}}var W=r(G.opacity)&&r(T.opacity)&&G.opacity!==T.opacity,H=!1;return a({},x,{stagger:O,springConfig:w,getOnUpdateFunc:function(e){return o[t]={spring:e.spring,onAnimationEnd:e.onAnimationEnd,difference:{translateXDifference:F,translateYDifference:V,prevRect:i,currentRect:g}},function(e){n[t]&&n[t].onSpringUpdate&&n[t].onSpringUpdate(e.getCurrentValue()),H||(H=!0,n[t]&&n[t].onStart&&n[t].onStart(E,y));var i=e.getCurrentValue();if(D.contains(E)){var r={matrix:[]};r.matrix=G.matrix.map(function(t,e){return p(t,T.matrix[e],i)}),W&&(r.opacity=p(G.opacity,T.opacity,i)),X(r)}else e.destroy()}},initializeFlip:function(){X({matrix:G.matrix,opacity:W?G.opacity:void 0,forceMinVals:_}),n[t]&&n[t].onStartImmediate&&n[t].onStartImmediate(E,y),I.transformOrigin?E.style.transformOrigin=I.transformOrigin:f&&(E.style.transformOrigin="0 0"),K.forEach(function(t){var e=t[0],i=t[1];i.transformOrigin?e.style.transformOrigin=i.transformOrigin:f&&(e.style.transformOrigin="0 0")})},onAnimationEnd:function(){delete o[t],"function"==typeof q&&q(),E.style.transform="",K.forEach(function(t){t[0].style.transform=""}),_&&E&&(E.style.minHeight="",E.style.minWidth=""),P.push(t),P.length>=U.length&&S(P)},isGestureControlled:C,delayUntil:I.delayUntil})}).filter(Boolean);if(U.forEach(function(t){return(0,t.initializeFlip)()}),m)return function(){};var V=U.filter(function(t){return t.delayUntil&&(e=t.delayUntil,U.filter(function(t){return t.id===e}).length);var e}),j={},M={},R={};V.forEach(function(t){t.stagger?(R[t.stagger]=!0,M[t.delayUntil]?M[t.delayUntil].push(t.stagger):M[t.delayUntil]=[t.stagger]):j[t.delayUntil]?j[t.delayUntil].push(t):j[t.delayUntil]=[t]});var k=U.filter(function(t){return t.stagger}).reduce(function(t,e){return t[e.stagger]?t[e.stagger].push(e):t[e.stagger]=[e],t},{}),T=U.filter(function(t){return-1===V.indexOf(t)});return T.forEach(function(t){t.onSpringActivate=function(){j[t.id]&&j[t.id].forEach(I),M[t.id]&&Object.keys(M[t.id].reduce(function(t,e){var i;return a(t,((i={})[e]=!0,i))},{})).forEach(function(t){w(k[t],v[t],C)})}}),function(){return U.length||S([]),T.filter(function(t){return!t.stagger}).forEach(I),Object.keys(k).forEach(function(t){R[t]||w(k[t],v[t],C)}),O}}();S?S({hideEnteringElements:k,animateEnteringElements:T,animateExitingElements:G,animateFlippedElements:K}):(k(),G().then(T),K())}({flippedElementPositionsBeforeUpdate:n.flippedElementPositions,cachedOrderedFlipIds:n.cachedOrderedFlipIds,isGestureControlled:this.isGestureControlled,containerEl:this.el,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.props.applyTransformOrigin,spring:this.props.spring,debug:this.props.debug,portalKey:this.props.portalKey,staggerConfig:this.props.staggerConfig,handleEnterUpdateDelete:this.props.handleEnterUpdateDelete,decisionData:{previous:t.decisionData,current:this.props.decisionData},onComplete:this.props.onComplete,onStart:this.props.onStart})},i.prototype.render=function(){var t=this,e=this.props,i=e.portalKey,r=n.createElement(G.Provider,{value:{inProgressAnimations:this.inProgressAnimations,setIsGestureInitiated:this.setIsGestureInitiated}},n.createElement(k.Provider,{value:this.flipCallbacks},n.createElement(e.element,{className:e.className,ref:function(e){return t.el=e}},this.props.children)));return i&&(r=n.createElement(T.Provider,{value:i},r)),r},i}(i.Component);function K(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(i[n]=t[n]);return i}L.defaultProps={applyTransformOrigin:!0,element:"div"};var B=function(t){var e=t.children,n=t.flipId,r=t.inverseFlipId,o=t.portalKey,s=t.gestureHandlers,l=K(t,["children","flipId","inverseFlipId","portalKey","gestureHandlers"]),p=e,c=function(t){return"function"==typeof t}(p);if(!c)try{p=i.Children.only(e)}catch(t){throw new Error("Each Flipped component must wrap a single child")}l.scale||l.translate||l.opacity||a(l,{translate:!0,scale:!0,opacity:!0});var u={};return u["data-flip-config"]=JSON.stringify(l),n?u["data-flip-id"]=String(n):r&&(u["data-inverse-flip-id"]=String(r)),o&&(u["data-portal-key"]=o),c?p(u):(s&&a(u,s),i.cloneElement(p,u))},q=function(t){var e=t.children,i=t.flipId,r=t.shouldFlip,s=t.shouldInvert,a=t.onAppear,l=t.onStart,p=t.onStartImmediate,c=t.onComplete,u=t.onExit,d=t.onSpringUpdate,f=t.gestureHandlers,h=K(t,["children","flipId","shouldFlip","shouldInvert","onAppear","onStart","onStartImmediate","onComplete","onExit","onSpringUpdate","gestureHandlers"]);return e?h.inverseFlipId?n.createElement(B,Object.assign({},h),e):n.createElement(T.Consumer,null,function(t){return n.createElement(k.Consumer,null,function(g){return o(g)&&i&&(g[i]={shouldFlip:r,shouldInvert:s,onAppear:a,onStart:l,onStartImmediate:p,onComplete:c,onExit:u,onSpringUpdate:d}),n.createElement(B,Object.assign({flipId:i},h,{portalKey:t,gestureHandlers:f}),e)})}):null};q.displayName="Flipped";var X=function(t){function e(){t.apply(this,arguments),this.processProps=function(t){return Object.assign({},t,{flipId:t.flipId?String(t.flipId):String(t.children.props.flipId)})},this.swipe=new M(this.processProps(this.props))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.componentDidUpdate=function(t){this.swipe.props=this.processProps(this.props),this.swipe.prevProps=this.processProps(t)},e.prototype.render=function(){return n.Children.only(this.props.children),i.cloneElement(this.props.children,"Flipped"===this.props.children.type.displayName?{gestureHandlers:this.swipe.handlers}:this.swipe.handlers)},e}(i.Component);exports.Flipper=L,exports.Flipped=q,exports.ExitContainer=function(t){var e;return i.cloneElement(t.children,((e={})["data-exit-container"]=!0,e))},exports.Swipe=function(t){return n.createElement(G.Consumer,null,function(e){return n.createElement(X,Object.assign({inProgressAnimations:e.inProgressAnimations,setIsGestureInitiated:e.setIsGestureInitiated},t))})},exports.spring=function(t){var e=t.values,i=t.onUpdate,n=t.delay;void 0===n&&(n=0);var r=t.onComplete,o=a({},c.noWobble,u(t.config)),s=o.overshootClamping,l=R.createSpring(o.stiffness,o.damping);return l.setOvershootClampingEnabled(!!s),l.addListener({onSpringAtRest:function(t){r&&r(),t.destroy()},onSpringUpdate:function(t){var n=t.getCurrentValue();if(!e)return i(n);var r=Object.keys(e).map(function(t){return[t,p(e[t][0],e[t][1],n)]}).reduce(function(t,e){var i;return Object.assign(t,((i={})[e[0]]=e[1],i))},{});i(r)}}),n?setTimeout(function(){l.setEndValue(1)},n):l.setEndValue(1),l};
//# sourceMappingURL=index.js.map
